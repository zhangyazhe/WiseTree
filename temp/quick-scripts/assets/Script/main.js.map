{"version":3,"sources":["main.js"],"names":["cc","Class","extends","Component","properties","lbScore","default","type","Label","lbTime","lbSeq","questionList","Node","onLoad","A_DEFINE","B_DEFINE","C_DEFINE","a","b","c","ans","seq","timecnt","qm","result_list","error_list","JSON","parse","sys","localStorage","getItem","start","defaultGame","log","schedule","doCountTime","string","toString","generateQuestion","randnum","Math","random","questionNum","round","url","loader","loadRes","SpriteFrame","err","res","console","error","starNode","setPosition","starSprite","addComponent","Sprite","spriteFrame","addChild","A_Clicked","result","refreshScore","push","refreshSeq","B_Clicked","C_Clicked","curScore","totalScore","node","stopAllActions","runAction","sequence","scaleTo","curSeq","find","getComponent","setdata","setItem","stringify","toScene","director","loadScene"],"mappings":"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","file":"main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //用于计分的Label控件\r\n        lbScore: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        lbTime: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        lbSeq: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        questionList:{\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n    },\r\n\r\n    onLoad () {\r\n        //用于定义包剪布在代码逻辑中的代号\r\n        this.A_DEFINE = 0;\r\n        this.B_DEFINE = 1;\r\n        this.C_DEFINE = 2;\r\n        //用于记录对应出拳的得分\r\n        this.a = 0;\r\n        this.b = 0;\r\n        this.c = 0;\r\n        //题目的答案\r\n        this.ans = 0;\r\n        //记录题号\r\n        this.seq = 1;\r\n        //记录时间\r\n        this.timecnt = 0;\r\n        //记录结果\r\n\t\tthis.qm = 0;\r\n\t\t//记录题号\r\n        this.result_list = [];\r\n\t\tthis.error_list = JSON.parse(cc.sys.localStorage.getItem('userData'));\r\n    },\r\n\r\n    start () {\r\n        this.defaultGame();\r\n        cc.log(\"start to run\");\r\n        this.schedule(this.doCountTime,1);\r\n    },\r\n\r\n    //倒计时\r\n    doCountTime(){\r\n        //每秒更新显示信息\r\n        this.timecnt += 1;\r\n        //刷新lable\r\n        this.lbTime.string = this.timecnt.toString();\r\n        // this.lbTime.node.stopAllActions();\r\n        // this.lbTime.node.runAction(cc.sequence(cc.scaleTo(0.1,1.3,1.3),cc.scaleTo(0.1,1,1)));\r\n    },\r\n\r\n    //重置游戏状态\r\n    defaultGame:function(){\r\n        this.b = 0;\r\n        this.c = 0;\r\n        this.a = 0;\r\n        this.ans = 0;\r\n        this.seq = 1;\r\n\t\t\r\n        //初始化显示的题目\r\n        this.generateQuestion();\r\n\t\t//cc.sys.localStorage.setItem(\"error\", error);\t\t\t//储存错题\r\n    },\r\n\r\n    //随机生成题目\r\n    generateQuestion:function(){\r\n        var randnum = Math.random()*149;//生成1~150的随机整数\r\n        var questionNum = Math.round(randnum + 1001);\r\n        var url = \"1/\" + questionNum.toString();\r\n        //记录答案\r\n\t\tthis.qm = randnum;         //记录题号\r\n        if(randnum >=1 && randnum <= 50){\r\n            this.ans = this.A_DEFINE;\r\n        }else if(randnum >=51 && randnum <= 100){\r\n            this.ans = this.B_DEFINE;\r\n        }else if(randnum >=101 && randnum <= 150){\r\n            this.ans = this.C_DEFINE;\r\n        }\r\n        cc.log(\"question url = \" + url);\r\n        cc.log(\"question answer is \" + this.ans.toString());\r\n        cc.loader.loadRes(url, cc.SpriteFrame, (err, res) => {\r\n            //加载错误则报错\r\n            if (err) {\r\n                console.error(err);\r\n                return;\r\n            }\r\n\r\n            //创建一个使用图片资源的新节点对象\r\n            let starNode = new cc.Node(); //创建一个新节点\r\n            //starNode.name = \"star1\";\r\n            starNode.setPosition(0,0); //创建随机的位置\r\n            let starSprite = starNode.addComponent(cc.Sprite); //增加精灵组件\r\n            starSprite.spriteFrame = res; //设置精灵组件图片资源\r\n            this.questionList.addChild(starNode); //场景中增加新节点\r\n        });\r\n    },\r\n\r\n    A_Clicked:function(){\r\n        var result = (this.A_DEFINE == this.ans);\r\n        if (result)\r\n        {\r\n            //成功消除计分\r\n            this.a += 1;\r\n            this.refreshScore();\r\n        }\r\n        if(result){\r\n            this.result_list.push(1);\r\n        }else{\r\n            this.result_list.push(0);\r\n\t\t\tthis.error_list.push(Math.round(this.qm));\r\n        }\r\n        this.refreshSeq();\r\n        if(this.seq != 31){\r\n            this.generateQuestion();\r\n\t\t\tcc.log(this.error_list.toString());\r\n        }\r\n        \r\n    },\r\n    \r\n    B_Clicked:function(){\r\n        var result = (this.B_DEFINE == this.ans);\r\n        if (result)\r\n        {\r\n            this.b += 1;\r\n            this.refreshScore();\r\n        }\r\n        if(result){\r\n            this.result_list.push(1);\r\n        }else{\r\n            this.result_list.push(0);\r\n\t\t\tthis.error_list.push(Math.round(this.qm));\r\n        }\r\n        this.refreshSeq();\r\n        if(this.seq != 31){\r\n            this.generateQuestion();\r\n\t\t\tcc.log(this.error_list.toString());\r\n        }\r\n    },\r\n    \r\n    C_Clicked:function(){\r\n        var result = (this.C_DEFINE == this.ans);\r\n        if (result)\r\n        { \r\n            this.c += 1;\r\n            this.refreshScore();\r\n        }\r\n        if(result){\r\n            this.result_list.push(1);\r\n        }else{\r\n            this.result_list.push(0);\r\n\t\t\tthis.error_list.push(Math.round(this.qm));\r\n        }\r\n        this.refreshSeq();\r\n        if(this.seq != 31){\r\n            this.generateQuestion();\r\n\t\t\tcc.log(this.error_list.toString());\r\n        }\r\n    },\r\n\r\n    //刷新得分\r\n    refreshScore:function(){\r\n        let curScore = this.totalScore();\r\n        this.lbScore.string = curScore.toString();\r\n        this.lbScore.node.stopAllActions();\r\n        this.lbScore.node.runAction(cc.sequence(cc.scaleTo(0.1,1.3,1.3),cc.scaleTo(0.1,1,1)));\r\n    },\r\n\r\n    totalScore:function(){\r\n        return this.a + this.b + this.c;\r\n    },\r\n\r\n    //刷新题号\r\n    refreshSeq:function(){\r\n        let curSeq = ++this.seq;\r\n        if(this.seq == 31){\r\n            //将时间装入待传递的数据中\r\n            this.result_list.push(this.timecnt);\r\n            //获取常驻结点进行场景间通信\r\n            var node = cc.find('main_persistNode').getComponent('main_persist');\r\n            node.setdata(this.result_list);\r\n\t\t\tcc.sys.localStorage.setItem('userData', JSON.stringify(this.error_list));\t\t\t//存储错题到本地数据库\r\n            this.toScene();\r\n        }else{\r\n            this.lbSeq.string = curSeq.toString();\r\n            this.lbSeq.node.stopAllActions();\r\n            this.lbSeq.node.runAction(cc.sequence(cc.scaleTo(0.1,1.3,1.3),cc.scaleTo(0.1,1,1)));\r\n        }\r\n    },\r\n\r\n    //跳转场景\r\n    toScene:function(){\r\n        cc.director.loadScene(\"result_scene\")\r\n    },\r\n\r\n});"]}